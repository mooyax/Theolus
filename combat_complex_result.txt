
 RUN  v4.0.15 C:/Users/mooya/develop/test

stdout | src/tests/CombatFixes.test.js
[DEBUG] Actor.ts loaded

stdout | src/tests/ComplexInteraction.test.js
[DEBUG] Building.ts loaded

stdout | src/tests/ComplexInteraction.test.js
[DEBUG] Terrain.ts top-level load

stdout | src/tests/ComplexInteraction.test.js
[DEBUG] Actor.ts loaded

stdout | src/tests/CombatFixes.test.js
[DEBUG] Goblin.ts loaded

stdout | src/tests/CombatFixes.test.js
[Import Debug] Raid: function, Combat: function, Wander: function

stdout | src/tests/ComplexInteraction.test.js
[DEBUG] Goblin.ts loaded

stdout | src/tests/ComplexInteraction.test.js
[Import Debug] Raid: function, Combat: function, Wander: function

stderr | src/tests/CombatFixes.test.js > Combat and Logic Fixes > should find target goblin
[Entity 0] CONSTRUCTOR START: type=unit at 0,0
[Entity 0] Calling registerEntity...
[Entity 0] registerEntity returned.
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[DIAG] Actor Created ID: 0
[DIAG] Actor smartMove type: function
[DIAG] Actor smartMove body snapshot: smartMove(tx, tz, time, depth = 0) {
    if (isNaN(tx) || isNaN(tz)) {
      console.error(`[Actor $
[UnitCore.js] Unit Created ID:0 Role:knight Pos:0,0 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:knight Pos:0,0
[UnitCore.js] Unit Construction Finished ID:0
DEBUG: Heights: 1 1
DEBUG: Distance: 10
[Unit 0] State Change: Wander -> Combat
[Unit 0] State Change: Combat -> Combat
DEBUG: Target Found: g1
DEBUG: Action: Chasing

 笨・src/tests/CombatFixes.test.js (1 test) 7ms
stdout | src/tests/ComplexInteraction.test.js
[DEBUG] Game.ts top-level load

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should immediately stop unit when job is cancelled mid-approach
[Entity 0] CONSTRUCTOR START: type=unit at 0,0
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[DIAG] Actor Created ID: 0
[DIAG] Actor smartMove type: function
[DIAG] Actor smartMove body snapshot: smartMove(tx, tz, time, depth = 0) {
    if (isNaN(tx) || isNaN(tz)) {
      console.error(`[Actor $
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0
[UnitCore.js] Unit Construction Finished ID:0
[Game] Constructor called. Instance ID: 1 (Minimal: false)
[Game] Init Basic State
[Game] Init Queues
[Game] Init Time
[GoblinManager] 5蛟九・豢樒ｪ溘ｒ逕滓・荳ｭ...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.414419, 0.888131) -> Grid(41, 88) rngState=undefined
GoblinManager: Cave registered at 41,88 
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.658232, 0.798654) -> Grid(65, 79) rngState=undefined
GoblinManager: Cave registered at 65,79 
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.663967, 0.985704) -> Grid(66, 98) rngState=undefined
GoblinManager: Cave registered at 66,98 
GoblinManager: Cave registered at 93,2 
GoblinManager: Cave registered at 79,26 
[GoblinManager] 豢樒ｪ溽函謌仙ｮ御ｺ・ 5/5 (隧ｦ陦悟屓謨ｰ: 5)
GoblinManager: Force spawning Debug Goblin
[Game] Generating Preview Terrain...
[Game] Preview Ready.
[Game] Initializing Start Screen Listeners...

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should immediately stop unit when job is cancelled mid-approach
[Game] Request Added: build at (20,0) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Actor 1] Resetting Unreachable (Target changed or initializing)

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should immediately stop unit when job is cancelled mid-approach
[Actor 1] Pathfinding SUCCESS: Got 1 nodes to 20,0
[Entity 1] startMove -> isMoving:true. Target:20,0 StartTime:0.0000

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should immediately stop unit when job is cancelled mid-approach
[Game] Cancelling Request req_0 at 20,0

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should pickup NEXT job if current is cancelled
[Entity 1] CONSTRUCTOR START: type=unit at 0,0
[Entity 1] Calling updatePosition...
[Entity 1] updatePosition returned.
[DIAG] Actor Created ID: 1
[DIAG] Actor smartMove type: function
[DIAG] Actor smartMove body snapshot: smartMove(tx, tz, time, depth = 0) {
    if (isNaN(tx) || isNaN(tz)) {
      console.error(`[Actor $
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0
[UnitCore.js] Unit Construction Finished ID:1
[Game] Constructor called. Instance ID: 2 (Minimal: false)
[Game] Init Basic State
[Game] Init Queues
[Game] Init Time
[GoblinManager] 5蛟九・豢樒ｪ溘ｒ逕滓・荳ｭ...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.110974, 0.899278) -> Grid(11, 89) rngState=undefined
GoblinManager: Cave registered at 11,89 
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.920914, 0.936253) -> Grid(92, 93) rngState=undefined
GoblinManager: Cave registered at 92,93 
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.535464, 0.811713) -> Grid(53, 81) rngState=undefined
GoblinManager: Cave registered at 53,81 
GoblinManager: Cave registered at 99,43 
GoblinManager: Cave registered at 11,59 
[GoblinManager] 豢樒ｪ溽函謌仙ｮ御ｺ・ 5/5 (隧ｦ陦悟屓謨ｰ: 5)
GoblinManager: Force spawning Debug Goblin
[Game] Generating Preview Terrain...
[Game] Preview Ready.
[Game] Initializing Start Screen Listeners...

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should pickup NEXT job if current is cancelled
[Game] Request Added: build at (20,0) ID:req_0
[Actor 1] Resetting Unreachable (Target changed or initializing)
[Game] Request Added: build at (-20,0) ID:req_1
[Actor 1] Pathfinding SUCCESS: Got 1 nodes to 20,0
[Entity 1] startMove -> isMoving:true. Target:20,0 StartTime:0.0000

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should pickup NEXT job if current is cancelled
[Game] Cancelling Request req_0 at 20,0
[Actor 1] Resetting Unreachable (Target changed or initializing)
[Actor 1] Resetting Unreachable (Target changed or initializing)
[Actor 1] Resetting Unreachable (Target changed or initializing)

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should pickup NEXT job if current is cancelled
[Actor 1] Pathfinding SUCCESS: Got 1 nodes to -20,0
[Entity 1] startMove -> isMoving:true. Target:-20,0 StartTime:3.0000

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should handle cancellation while Working (arrived)
[Entity 2] CONSTRUCTOR START: type=unit at 0,0
[Entity 2] Calling updatePosition...
[Entity 2] updatePosition returned.
[DIAG] Actor Created ID: 2
[DIAG] Actor smartMove type: function
[DIAG] Actor smartMove body snapshot: smartMove(tx, tz, time, depth = 0) {
    if (isNaN(tx) || isNaN(tz)) {
      console.error(`[Actor $
[UnitCore.js] Unit Created ID:2 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:2 Role:worker Pos:0,0
[UnitCore.js] Unit Construction Finished ID:2
[Game] Constructor called. Instance ID: 3 (Minimal: false)
[Game] Init Basic State
[Game] Init Queues
[Game] Init Time
[GoblinManager] 5蛟九・豢樒ｪ溘ｒ逕滓・荳ｭ...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.841929, 0.790111) -> Grid(84, 79) rngState=undefined
GoblinManager: Cave registered at 84,79 
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.112164, 0.633190) -> Grid(11, 63) rngState=undefined
GoblinManager: Cave registered at 11,63 
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.125394, 0.517986) -> Grid(12, 51) rngState=undefined
GoblinManager: Cave registered at 12,51 
GoblinManager: Cave registered at 33,80 
GoblinManager: Cave registered at 56,85 
[GoblinManager] 豢樒ｪ溽函謌仙ｮ御ｺ・ 5/5 (隧ｦ陦悟屓謨ｰ: 5)
GoblinManager: Force spawning Debug Goblin
[Game] Generating Preview Terrain...
[Game] Preview Ready.
[Game] Initializing Start Screen Listeners...

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should handle cancellation while Working (arrived)
[Game] Request Added: build at (20,0) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Actor 1] Resetting Unreachable (Target changed or initializing)

stderr | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should handle cancellation while Working (arrived)
[Actor 1] Pathfinding FAILED: Empty/Short path returned. Current Pos: 20,0 -> Target: 20,0 Len:1 Short:true

 笨・src/tests/ComplexInteraction.test.js (3 tests) 39ms

 Test Files  2 passed (2)
      Tests  4 passed (4)
   Start at  00:07:48
   Duration  1.31s (transform 609ms, setup 172ms, import 820ms, tests 46ms, environment 1.12s)

