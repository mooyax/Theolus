
 RUN  v4.0.15 C:/Users/mooya/develop/test

stdout | src/tests/LoadUpdateLoop.test.js > Load Update Loop Integration > should maintain JobState after first update loop post-load
Scene created: [33mtrue[39m Pos: object
Camera created: [33mtrue[39m Pos: object
Camera setup done
Creating Terrain...
Terrain created: [33mtrue[39m

stdout | src/tests/LoadUpdateLoop.test.js > Load Update Loop Integration > should maintain JobState after first update loop post-load
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
Setup Unit updateLogic type: function
[Game] Request Added: raise at (15,15) ID:req_0
[Game] forceAssignRequest FOUND Unit 100 (DistSq:50). Scanned:1
[Game] Request req_0 assigned/switched to Unit 100
Game SaveManager present: [33mtrue[39m
Game SaveManager save method: function
Saving Game Data: {
  slotId: [33m1[39m,
  timestamp: [33m1767629506066[39m,
  resources: { grain: [33m10[39m, fish: [33m10[39m, meat: [33m10[39m },
  gameTime: [33m8[39m,
  gameTotalTime: [33m0[39m,
  currentSeasonIndex: [90mundefined[39m,
  daysPassed: [90mundefined[39m,
  terrain: { grid: [], width: [33m20[39m, depth: [33m20[39m },
  units: [
    {
      id: [33m100[39m,
      gridX: [33m10[39m,
      gridZ: [33m10[39m,
      age: [33m20[39m,
      lifespan: [33m86.18278609939797[39m,
      isDead: [33mfalse[39m,
      isFinished: [90mundefined[39m,
      isMoving: [33mtrue[39m,
      targetX: [33m0[39m,
      targetZ: [33m0[39m,
      moveStartTime: [33m0[39m,
      moveDuration: [33m1.1313708498984762[39m,
      startGridX: [33m10[39m,
      startGridZ: [33m10[39m,
      targetGridX: [33m11[39m,
      targetGridZ: [33m11[39m,
      isSpecial: [33mfalse[39m,
      role: [32m'worker'[39m,
      hp: [33m46[39m,
      maxHp: [33m46[39m,
      damage: [33m4[39m,
      xp: [33m0[39m,
      level: [33m1[39m,
      name: [90mundefined[39m,
      homeBaseGridX: [90mundefined[39m,
      homeBaseGridZ: [90mundefined[39m,
      squadId: [1mnull[22m,
      targetRequestId: [32m'req_manual_persistent'[39m
    }
  ],
  goblinManager: {},
  camera: {
    position: { x: [33m20[39m, y: [33m20[39m, z: [33m20[39m },
    zoom: [90mundefined[39m,
    target: { x: [90mundefined[39m, y: [90mundefined[39m, z: [90mundefined[39m }
  },
  requests: [
    {
      id: [32m'req_manual_persistent'[39m,
      type: [32m'raise'[39m,
      x: [33m15[39m,
      z: [33m15[39m,
      status: [32m'assigned'[39m,
      assignedTo: [33m100[39m,
      createdAt: [33m0[39m,
      isManual: [33mtrue[39m
    }
  ]
}
saveGame result: [33mtrue[39m
localStorage setItem calls: [33m1[39m
Load Started...

stdout | src/tests/LoadUpdateLoop.test.js > Load Update Loop Integration > should maintain JobState after first update loop post-load
Load Game: Data found {
  slotId: [33m1[39m,
  timestamp: [33m1767629506066[39m,
  resources: { grain: [33m10[39m, fish: [33m10[39m, meat: [33m10[39m },
  gameTime: [33m8[39m,
  gameTotalTime: [33m0[39m,
  terrain: { grid: [], width: [33m20[39m, depth: [33m20[39m },
  units: [
    {
      id: [33m100[39m,
      gridX: [33m10[39m,
      gridZ: [33m10[39m,
      age: [33m20[39m,
      lifespan: [33m86.18278609939797[39m,
      isDead: [33mfalse[39m,
      isMoving: [33mtrue[39m,
      targetX: [33m0[39m,
      targetZ: [33m0[39m,
      moveStartTime: [33m0[39m,
      moveDuration: [33m1.1313708498984762[39m,
      startGridX: [33m10[39m,
      startGridZ: [33m10[39m,
      targetGridX: [33m11[39m,
      targetGridZ: [33m11[39m,
      isSpecial: [33mfalse[39m,
      role: [32m'worker'[39m,
      hp: [33m46[39m,
      maxHp: [33m46[39m,
      damage: [33m4[39m,
      xp: [33m0[39m,
      level: [33m1[39m,
      squadId: [1mnull[22m,
      targetRequestId: [32m'req_manual_persistent'[39m
    }
  ],
  goblinManager: {},
  camera: { position: { x: [33m20[39m, y: [33m20[39m, z: [33m20[39m }, target: {} },
  requests: [
    {
      id: [32m'req_manual_persistent'[39m,
      type: [32m'raise'[39m,
      x: [33m15[39m,
      z: [33m15[39m,
      status: [32m'assigned'[39m,
      assignedTo: [33m100[39m,
      createdAt: [33m0[39m,
      isManual: [33mtrue[39m
    }
  ]
}
Clearing 0 projectiles...

stdout | src/tests/LoadUpdateLoop.test.js > Load Update Loop Integration > should maintain JobState after first update loop post-load
[UnitCore.js] Unit Created ID:1 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:10,10
[Game] Restoring 1 requests...
[Game] Re-linked Unit 100 to Request req_manual_persistent
[Game] Restored Camera Zoom: 1

stdout | src/tests/LoadUpdateLoop.test.js > Load Update Loop Integration > should maintain JobState after first update loop post-load
Restored Unit Keys: [
  [32m'id'[39m,                   [32m'scene'[39m,                [32m'terrain'[39m,
  [32m'gridX'[39m,                [32m'gridZ'[39m,                [32m'type'[39m,
  [32m'spatialType'[39m,          [32m'position'[39m,             [32m'rotationY'[39m,
  [32m'isMoving'[39m,             [32m'moveTimer'[39m,            [32m'moveDuration'[39m,
  [32m'moveStartTime'[39m,        [32m'startGridX'[39m,           [32m'startGridZ'[39m,
  [32m'targetGridX'[39m,          [32m'targetGridZ'[39m,          [32m'walkAnimTimer'[39m,
  [32m'path'[39m,                 [32m'pathIndex'[39m,            [32m'stuckCount'[39m,
  [32m'pathFailCount'[39m,        [32m'lastPathTime'[39m,         [32m'minDistToTarget'[39m,
  [32m'pathStagnation'[39m,       [32m'state'[39m,                [32m'simTime'[39m,
  [32m'role'[39m,                 [32m'isSpecial'[39m,            [32m'squadId'[39m,
  [32m'lastGridX'[39m,            [32m'lastGridZ'[39m,            [32m'stagnationTimer'[39m,
  [32m'buildStagnationCount'[39m, [32m'lastTime'[39m,             [32m'lastGatherTime'[39m,
  [32m'limbs'[39m,                [32m'lifespan'[39m,             [32m'age'[39m,
  [32m'isSleeping'[39m,           [32m'isNight'[39m,              [32m'isDead'[39m,
  [32m'debugFrame'[39m,           [32m'hp'[39m,                   [32m'maxHp'[39m,
  [32m'attackCooldown'[39m,       [32m'attackRate'[39m,           [32m'damage'[39m,
  [32m'targetGoblin'[39m,         [32m'ignoredTargets'[39m,       [32m'moveInterval'[39m,
  [32m'huntingCooldown'[39m,      [32m'target'[39m,               [32m'targetX'[39m,
  [32m'targetZ'[39m,              [32m'action'[39m,               [32m'wanderCount'[39m,
  [32m'migrationTarget'[39m,      [32m'isFinished'[39m,           [32m'xp'[39m,
  [32m'level'[39m,                [32m'savedTargetRequestId'[39m, [32m'targetRequest'[39m,
  [32m'targetBuilding'[39m
]
[Defense Debug 100] shouldScan:false isBusy:true force:false PassedGoblins:None
Unit maintained JobState.

 ç¬¨ãƒ»src/tests/LoadUpdateLoop.test.js > Load Update Loop Integration > should maintain JobState after first update loop post-load 273ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  01:11:45
   Duration  1.29s (transform 350ms, setup 52ms, import 402ms, tests 277ms, environment 390ms)

