
[1m[46m RUN [49m[22m [36mv4.0.15 [39m[90mC:/Users/mooya/develop/test[39m

[90mstdout[2m | src/tests/GoblinEncounter.test.js[2m > [22m[2mGoblin Encounter Logic[2m > [22m[2mGoblin should detect Worker within range and enter CombatState
[22m[39m[UnitCore.js] Unit Created ID:0 Role:worker Pos:30,20 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:30,20
[Test Debug] Worker keys: id,scene,terrain,game,frameCount,gridX,gridZ,type,spatialType,position,rotationY,isMoving,moveTimer,moveDuration,moveStartTime,startGridX,startGridZ,targetGridX,targetGridZ,walkAnimTimer,_spatial,path,pathIndex,stuckCount,pathFailCount,lastPathTime,isPathfinding,minDistToTarget,pathStagnation,state,simTime,role,isSpecial,squadId,lastGridX,lastGridZ,stagnationTimer,buildStagnationCount,lastTime,lastGatherTime,limbs,hp,maxHp,attackCooldown,attackRate,damage,targetGoblin,targetRaidPoint,lifespan,age,isDead,isSleeping,ignoredTargets,moveInterval,huntingCooldown,target,targetX,targetZ,action,wanderCount,migrationTarget,patrolTarget,patrolTimer,debugFrame
[GoblinState Debug] ID:100 Calling scanForTargets...
[Goblin 100] scanForTargets called. State:GoblinWanderState UnitTgt:No Frust:false
[Goblin 100] invoking terrain.findBestTarget (Units)...
[Terrain Debug] findBestTarget CALL. Type:unit At:20.0,20.0 Range:20
[Goblin 100] Found Unit Candidate: 200 Dist:?
[Goblin 100] Simple Choice: 200
[Goblin 100] Target LOCKED: 200 Type:worker State:GoblinWanderState
[GoblinState 100] ENTER CombatState. Target: Unit 200
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0
[Goblin 100] ExecCombat. Tgt:200 State:GoblinCombatState Dist:10.0

 [32mç¬¨ãƒ»[39m src/tests/GoblinEncounter.test.js[2m > [22mGoblin Encounter Logic[2m > [22mGoblin should detect Worker within range and enter CombatState[33m 813[2mms[22m[39m
[90mstdout[2m | src/tests/GoblinEncounter.test.js[2m > [22m[2mGoblin Encounter Logic[2m > [22m[2mGoblin should prioritize Worker if Building is far, or attack Building if close
[22m[39m[UnitCore.js] Unit Created ID:1 Role:worker Pos:30,20 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:30,20
[Terrain Debug] findBestTarget CALL. Type:unit At:20.0,20.0 Range:20
[Goblin 101] Found Unit Candidate: 201 Dist:?
[Goblin 101] Simple Choice: 201
[Goblin 101] Target LOCKED: 201 Type:worker State:GoblinWanderState
[GoblinState 101] ENTER CombatState. Target: Unit 201

 [32mç¬¨ãƒ»[39m src/tests/GoblinEncounter.test.js[2m > [22mGoblin Encounter Logic[2m > [22mGoblin should prioritize Worker if Building is far, or attack Building if close[33m 748[2mms[22m[39m
 [31mï¾ƒãƒ»[39m src/tests/GoblinEncounter.test.js[2m > [22mGoblin Encounter Logic[2m > [22mGoblin should switch target to Worker if it encounters one while moving to a far Building[33m 947[2mms[22m[39m
[31m   ç«Šãƒ»GoblinRaidState is not defined[39m

[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 11:53:05
[2m   Duration [22m 3.44s[2m (transform 250ms, setup 45ms, import 310ms, tests 2.51s, environment 390ms)[22m

