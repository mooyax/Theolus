
 RUN  v4.0.15 C:/Users/mooya/develop/test

 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should initialize with correct default values 11ms
   ç«Šãƒ»expected undefined to be +0 // Object.is equality
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should enable and disable correctly 1ms
   ç«Šãƒ»expected undefined to be false // Object.is equality
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should toggle state 1ms
   ç«Šãƒ»expected undefined to be false // Object.is equality
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should measure update time 2ms
   ç«Šãƒ»Cannot read properties of undefined (reading 'updateTime')
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should measure render time 2ms
   ç«Šãƒ»Cannot read properties of undefined (reading 'renderTime')
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should update entity counts 0ms
   ç«Šãƒ»Cannot read properties of undefined (reading 'entities')
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should measure FPS over time 1ms
   ç«Šãƒ»expected undefined to be +0 // Object.is equality
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should add data to history 0ms
   ç«Šãƒ»Cannot set properties of undefined (setting 'updateTime')
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should limit history length 1ms
   ç«Šãƒ»Cannot read properties of undefined (reading 'maxHistoryLength')
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should get stats correctly 0ms
   ç«Šãƒ»Cannot set properties of undefined (setting 'minFps')
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should reset stats 0ms
   ç«Šãƒ»Cannot set properties of undefined (setting 'minFps')
 ï¾ƒãƒ»src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should update with game instance 0ms
   ç«Šãƒ»Cannot read properties of undefined (reading 'entities')
stdout | src/tests/EncounterCombat.test.js > Encounter Combat Logic > Unit should switch target to nearby Goblin while moving to distant Building
[TestDebug] beforeEach finished. game.scene exists? [33mtrue[39m

stdout | src/tests/EncounterCombat.test.js > Encounter Combat Logic > Unit should switch target to nearby Goblin while moving to distant Building
[Entity 0] Calling registerEntity...
[Entity 0] registerEntity returned.
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:soldier Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:soldier Pos:10,10
Goblin constructor: calling super...
[Entity 1] Calling registerEntity...
[Entity 1] registerEntity returned.
[Entity 1] Calling updatePosition...
[Entity 1] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 20,20
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Actor 0] CHANGE STATE: None -> Wander Request:null

stdout | src/tests/EncounterCombat.test.js > Encounter Combat Logic > Goblin should switch target to nearby Unit while moving to distant Building
[TestDebug] beforeEach finished. game.scene exists? [33mtrue[39m

stdout | src/tests/EncounterCombat.test.js > Encounter Combat Logic > Goblin should switch target to nearby Unit while moving to distant Building
Goblin constructor: calling super...
[Entity 2] Calling registerEntity...
[Entity 2] registerEntity returned.
[Entity 2] Calling updatePosition...
[Entity 2] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Entity 3] Calling registerEntity...
[Entity 3] registerEntity returned.
[Entity 3] Calling updatePosition...
[Entity 3] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 20,20
[UnitCore.js] Unit Created ID:1 Role:soldier Pos:20,20 Special:false
[UnitCore.js] Unit Created ID:1 Role:soldier Pos:20,20
[GoblinState 3] Encounter! Switching from Building to Nearby Unit 4

stdout | src/tests/EncounterCombat.test.js > Encounter Combat Logic > Worker should reduce scan range (Worker Aggression Fix)
[TestDebug] beforeEach finished. game.scene exists? [33mtrue[39m

stdout | src/tests/EncounterCombat.test.js > Encounter Combat Logic > Worker should reduce scan range (Worker Aggression Fix)
[Entity 4] Calling registerEntity...
[Entity 4] registerEntity returned.
[Entity 4] Calling updatePosition...
[Entity 4] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:2 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:2 Role:worker Pos:10,10

 ï¾ƒãƒ»src/tests/EncounterCombat.test.js > Encounter Combat Logic > Unit should switch target to nearby Goblin while moving to distant Building 25ms
   ç«Šãƒ»expected false to be true // Object.is equality
 ç¬¨ãƒ»src/tests/EncounterCombat.test.js > Encounter Combat Logic > Goblin should switch target to nearby Unit while moving to distant Building 3ms
 ç¬¨ãƒ»src/tests/EncounterCombat.test.js > Encounter Combat Logic > Worker should reduce scan range (Worker Aggression Fix) 2ms

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ Failed Tests 13 ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯

 FAIL  src/tests/EncounterCombat.test.js > Encounter Combat Logic > Unit should switch target to nearby Goblin while moving to distant Building
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ç¬¶ï½¯ src/tests/EncounterCombat.test.js:147:26
    145|             }
    146|         }
    147|         expect(switched).toBe(true);
       |                          ^
    148|     });
    149| 

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[1/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should initialize with correct default values
AssertionError: expected undefined to be +0 // Object.is equality

- Expected: 
0

+ Received: 
undefined

 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:12:29
     10| 
     11|     it('should initialize with correct default values', () => {
     12|         expect(monitor.fps).toBe(0);
       |                             ^
     13|         expect(monitor.enabled).toBe(false);
     14|         expect(monitor.metrics.entities.total).toBe(0);

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[2/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should enable and disable correctly
AssertionError: expected undefined to be false // Object.is equality

- Expected: 
false

+ Received: 
undefined

 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:18:33
     16| 
     17|     it('should enable and disable correctly', () => {
     18|         expect(monitor.enabled).toBe(false);
       |                                 ^
     19| 
     20|         monitor.enable();

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[3/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should toggle state
AssertionError: expected undefined to be false // Object.is equality

- Expected: 
false

+ Received: 
undefined

 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:28:33
     26| 
     27|     it('should toggle state', () => {
     28|         expect(monitor.enabled).toBe(false);
       |                                 ^
     29| 
     30|         monitor.toggle();

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[4/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should measure update time
TypeError: Cannot read properties of undefined (reading 'updateTime')
 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:44:32
     42|         monitor.endUpdate();
     43| 
     44|         expect(monitor.metrics.updateTime).toBeGreaterThan(0);
       |                                ^
     45|         expect(monitor.metrics.lastUpdateDuration).toBeGreaterThan(0);
     46|     });

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[5/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should measure render time
TypeError: Cannot read properties of undefined (reading 'renderTime')
 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:54:32
     52|         monitor.endRender();
     53| 
     54|         expect(monitor.metrics.renderTime).toBeGreaterThan(0);
       |                                ^
     55|         expect(monitor.metrics.lastRenderDuration).toBeGreaterThan(0);
     56|     });

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[6/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should update entity counts
TypeError: Cannot read properties of undefined (reading 'entities')
 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:61:32
     59|         monitor.updateEntityCount(10, 5, 3);
     60| 
     61|         expect(monitor.metrics.entities.units).toBe(10);
       |                                ^
     62|         expect(monitor.metrics.entities.goblins).toBe(5);
     63|         expect(monitor.metrics.entities.buildings).toBe(3);

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[7/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should measure FPS over time
AssertionError: expected undefined to be +0 // Object.is equality

- Expected: 
0

+ Received: 
undefined

 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:69:29
     67|     it('should measure FPS over time', () => {
     68|         // \u521d\u671fFPS\u306f0
     69|         expect(monitor.fps).toBe(0);
       |                             ^
     70| 
     71|         // \u30d5\u30ec\u30fc\u30e0\u3092\u30b7\u30df\u30e5\u30ec\u30fçª¶ï½¦

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[8/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should add data to history
TypeError: Cannot set properties of undefined (setting 'updateTime')
 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:83:36
     81|     it('should add data to history', () => {
     82|         monitor.fps = 60;
     83|         monitor.metrics.updateTime = 10;
       |                                    ^
     84|         monitor.metrics.renderTime = 5;
     85|         monitor.metrics.entities.total = 100;

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[9/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should limit history length
TypeError: Cannot read properties of undefined (reading 'maxHistoryLength')
 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:97:43
     95| 
     96|     it('should limit history length', () => {
     97|         const maxLength = monitor.history.maxHistoryLength;
       |                                           ^
     98| 
     99|         // \u6700\u5927\u9577\u3088\u308a\u591a\u3044\u30c7\u30fc\u30bçª¶ï½¦

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[10/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should get stats correctly
TypeError: Cannot set properties of undefined (setting 'minFps')
 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:112:30
    110|     it('should get stats correctly', () => {
    111|         monitor.fps = 60;
    112|         monitor.stats.minFps = 30;
       |                              ^
    113|         monitor.stats.maxFps = 75;
    114|         monitor.metrics.updateTime = 8;

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[11/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should reset stats
TypeError: Cannot set properties of undefined (setting 'minFps')
 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:131:30
    129|     it('should reset stats', () => {
    130|         // \u521d\u671f\u5024\u3092\u8a2d\u5b9a
    131|         monitor.stats.minFps = 30;
       |                              ^
    132|         monitor.stats.maxFps = 75;
    133|         monitor.history.fps = [60, 55, 58];

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[12/13]ç«¡ï½¯

 FAIL  src/tests/PerformanceMonitor.test.js > PerformanceMonitor > should update with game instance
TypeError: Cannot read properties of undefined (reading 'entities')
 ç¬¶ï½¯ src/tests/PerformanceMonitor.test.js:152:32
    150|         monitor.update(mockGame);
    151| 
    152|         expect(monitor.metrics.entities.units).toBe(3);
       |                                ^
    153|         expect(monitor.metrics.entities.goblins).toBe(2);
    154|         expect(monitor.metrics.entities.buildings).toBe(1);

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[13/13]ç«¡ï½¯


 Test Files  2 failed (2)
      Tests  13 failed | 2 passed (15)
   Start at  16:29:03
   Duration  1.65s (transform 434ms, setup 202ms, import 456ms, tests 54ms, environment 1.21s)

