
 RUN  v4.0.15 C:/Users/mooya/develop/test

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should assign a manual request to an Idle worker
Game constructor called

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should assign a manual request to an Idle worker
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0
[Game] Request Added: build at (10,10) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:200). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit 1] Moving onto Rock at 0,1 H:10 (Speed Penalty)
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 200.0)

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should NOT assign to a Busy worker (already working)
Game constructor called

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should NOT assign to a Busy worker (already working)
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0
[Game] Request Added: build at (10,10) ID:req_0
[Game] forceAssignRequest FAILED for Req req_0. Scanned:1 (RoleSkipped:0) Busy:1 Valid:0. TotalUnits:1

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should assign to a Wandering worker (Low Priority)
Game constructor called

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should assign to a Wandering worker (Low Priority)
[UnitCore.js] Unit Created ID:2 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:2 Role:worker Pos:0,0
[Game] Request Added: build at (10,10) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:200). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit 1] Moving onto Rock at 0,1 H:10 (Speed Penalty)
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 200.0)

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should assign to a Moving worker (Low Priority)
Game constructor called

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should assign to a Moving worker (Low Priority)
[UnitCore.js] Unit Created ID:3 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:3 Role:worker Pos:0,0
[Game] Request Added: build at (10,10) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:200). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit 1] Moving onto Rock at 0,1 H:10 (Speed Penalty)
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 200.0)

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should re-assign a unit that is "Moving" to a job (Not yet Working)
Game constructor called

stdout | src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should re-assign a unit that is "Moving" to a job (Not yet Working)
[UnitCore.js] Unit Created ID:4 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:4 Role:worker Pos:0,0
[Game] forceAssignRequest FAILED for Req req_new. Scanned:1 (RoleSkipped:0) Busy:1 Valid:0. TotalUnits:1

 ç¬¶ï½¯ src/tests/ManualAssignment.test.js (5 tests | 1 failed) 56ms
     ç¬¨ãƒ»should assign a manual request to an Idle worker 22ms
     ç¬¨ãƒ»should NOT assign to a Busy worker (already working) 6ms
     ç¬¨ãƒ»should assign to a Wandering worker (Low Priority) 3ms
     ç¬¨ãƒ»should assign to a Moving worker (Low Priority) 3ms
     ï¾ƒãƒ»should re-assign a unit that is "Moving" to a job (Not yet Working) 20ms
stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should immediately stop unit when job is cancelled mid-approach
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0
Game constructor called
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 31,148. Force:false
[Terrain] Building Added: cave at (31, 148) Size:1x1. Total: 1
GoblinManager: Cave registered at 31,148 
[GoblinManager] Clan clan_cave_31_148 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 116,37. Force:false
[Terrain] Building Added: cave at (116, 37) Size:1x1. Total: 2
GoblinManager: Cave registered at 116,37 
[GoblinManager] Clan clan_cave_116_37 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 39,153. Force:false
[Terrain] Building Added: cave at (39, 153) Size:1x1. Total: 3
GoblinManager: Cave registered at 39,153 
[GoblinManager] Clan clan_cave_39_153 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 115,28. Force:false
[Terrain] Building Added: cave at (115, 28) Size:1x1. Total: 4
GoblinManager: Cave registered at 115,28 
[GoblinManager] Clan clan_cave_115_28 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 52,88. Force:false
[Terrain] Building Added: cave at (52, 88) Size:1x1. Total: 5
GoblinManager: Cave registered at 52,88 
[GoblinManager] Clan clan_cave_52_88 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 17 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should immediately stop unit when job is cancelled mid-approach
[Game] Request Added: build at (20,0) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 400.0)
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Cancelling active job for Unit 1
[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:1
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 400.0)
[Game] Request Canceled at 20,0 (Target: 20,0)
DEBUG: TargetRequest: [1mnull[22m
DEBUG: Queue Length: [33m0[39m

stdout | src/tests/MultiJob.test.js > Multi-Job Juggling Verification > should NOT interrupt busy units when a new job is added
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0
Game constructor called
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 43,107. Force:false
[Terrain] Building Added: cave at (43, 107) Size:1x1. Total: 1
GoblinManager: Cave registered at 43,107 
[GoblinManager] Clan clan_cave_43_107 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 135,148. Force:false
[Terrain] Building Added: cave at (135, 148) Size:1x1. Total: 2
GoblinManager: Cave registered at 135,148 
[GoblinManager] Clan clan_cave_135_148 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 24,116. Force:false
[Terrain] Building Added: cave at (24, 116) Size:1x1. Total: 3
GoblinManager: Cave registered at 24,116 
[GoblinManager] Clan clan_cave_24_116 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 51,112. Force:false
[Terrain] Building Added: cave at (51, 112) Size:1x1. Total: 4
GoblinManager: Cave registered at 51,112 
[GoblinManager] Clan clan_cave_51_112 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 120,138. Force:false
[Terrain] Building Added: cave at (120, 138) Size:1x1. Total: 5
GoblinManager: Cave registered at 120,138 
[GoblinManager] Clan clan_cave_120_138 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 20 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

stdout | src/tests/MultiJob.test.js > Multi-Job Juggling Verification > should NOT interrupt busy units when a new job is added
[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:2
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request 101 to Unit 1 (Score: 400.0)
[Game] forceAssignRequest FOUND Unit 2 (DistSq:400). Scanned:2
[Defense Debug 2] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request 102 to Unit 2 (Score: 400.0)
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Defense Debug 2] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Request Added: build at (10,10) ID:req_0
[Game] forceAssignRequest FAILED for Req req_0. Scanned:2 (RoleSkipped:0) Busy:2 Valid:0. TotalUnits:2
[Game] forceAssignRequest FAILED for Req req_0. Scanned:2 (RoleSkipped:0) Busy:2 Valid:0. TotalUnits:2

 ç¬¨ãƒ»src/tests/MultiJob.test.js (1 test) 2750ms
     ç¬¨ãƒ»should NOT interrupt busy units when a new job is added  2748ms
stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should pickup NEXT job if current is cancelled
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0
Game constructor called
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 117,86. Force:false
[Terrain] Building Added: cave at (117, 86) Size:1x1. Total: 1
GoblinManager: Cave registered at 117,86 
[GoblinManager] Clan clan_cave_117_86 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 140,143. Force:false
[Terrain] Building Added: cave at (140, 143) Size:1x1. Total: 2
GoblinManager: Cave registered at 140,143 
[GoblinManager] Clan clan_cave_140_143 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 158,150. Force:false
[Terrain] Building Added: cave at (158, 150) Size:1x1. Total: 3
GoblinManager: Cave registered at 158,150 
[GoblinManager] Clan clan_cave_158_150 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 22,33. Force:false
[Terrain] Building Added: cave at (22, 33) Size:1x1. Total: 4
GoblinManager: Cave registered at 22,33 
[GoblinManager] Clan clan_cave_22_33 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 105,112. Force:false
[Terrain] Building Added: cave at (105, 112) Size:1x1. Total: 5
GoblinManager: Cave registered at 105,112 
[GoblinManager] Clan clan_cave_105_112 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 9 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should pickup NEXT job if current is cancelled
[Game] Request Added: build at (20,0) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 400.0)
[Game] Request Added: build at (-20,0) ID:req_1
[Game] forceAssignRequest FAILED for Req req_1. Scanned:1 (RoleSkipped:0) Busy:1 Valid:0. TotalUnits:1
[Game] forceAssignRequest FAILED for Req req_1. Scanned:1 (RoleSkipped:0) Busy:1 Valid:0. TotalUnits:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Cancelling active job for Unit 1
[Game] forceAssignRequest FAILED for Req req_0. Scanned:1 (RoleSkipped:0) Busy:1 Valid:0. TotalUnits:1
[Game] Request Canceled at 20,0 (Target: 20,0)
[Unit 1] Moving onto Rock at 19,0 H:10 (Speed Penalty)

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should handle cancellation while Working (arrived)
[UnitCore.js] Unit Created ID:2 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:2 Role:worker Pos:0,0
Game constructor called
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 37,89. Force:false
[Terrain] Building Added: cave at (37, 89) Size:1x1. Total: 1
GoblinManager: Cave registered at 37,89 
[GoblinManager] Clan clan_cave_37_89 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 17,41. Force:false
[Terrain] Building Added: cave at (17, 41) Size:1x1. Total: 2
GoblinManager: Cave registered at 17,41 
[GoblinManager] Clan clan_cave_17_41 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 140,86. Force:false
[Terrain] Building Added: cave at (140, 86) Size:1x1. Total: 3
GoblinManager: Cave registered at 140,86 
[GoblinManager] Clan clan_cave_140_86 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 7,73. Force:false
[Terrain] Building Added: cave at (7, 73) Size:1x1. Total: 4
GoblinManager: Cave registered at 7,73 
[GoblinManager] Clan clan_cave_7_73 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 19,46. Force:false
[Terrain] Building Added: cave at (19, 46) Size:1x1. Total: 5
GoblinManager: Cave registered at 19,46 
[GoblinManager] Clan clan_cave_19_46 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 5 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

stderr | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should handle cancellation while Working (arrived)
[JobState] Chaining Check. Game:Y Next:null

stdout | src/tests/ComplexInteraction.test.js > Complex Job Interaction and Cancellation > should handle cancellation while Working (arrived)
[Game] Request Added: build at (20,0) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 400.0)
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None

 ç¬¨ãƒ»src/tests/ComplexInteraction.test.js (3 tests) 5757ms
     ç¬¨ãƒ»should immediately stop unit when job is cancelled mid-approach  2417ms
     ç¬¨ãƒ»should pickup NEXT job if current is cancelled  1764ms
     ç¬¨ãƒ»should handle cancellation while Working (arrived)  1575ms

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ Failed Tests 1 ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯

 FAIL  src/tests/ManualAssignment.test.js > Manual Assignment Debugging > should re-assign a unit that is "Moving" to a job (Not yet Working)
AssertionError: expected { id: 'req_old', x: 50, z: 50, çª¶ï½¦(2) } to be { id: 'req_new', x: 10, z: 10, çª¶ï½¦(2) } // Object.is equality

- Expected
+ Received

  {
-   "id": "req_new",
-   "status": "pending",
-   "type": "build",
-   "x": 10,
-   "z": 10,
+   "assignedTo": 10,
+   "id": "req_old",
+   "status": "assigned",
+   "x": 50,
+   "z": 50,
  }

 ç¬¶ï½¯ src/tests/ManualAssignment.test.js:206:33
    204| 
    205|         // Expectation: The unit should switch to the NEW request
    206|         expect(u.targetRequest).toBe(req);
       |                                 ^
    207|         expect(req.assignedTo).toBe(u.id);
    208|         expect(req.status).toBe('assigned');

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[1/1]ç«¡ï½¯


 Test Files  1 failed | 2 passed (3)
      Tests  1 failed | 8 passed (9)
   Start at  22:38:24
   Duration  7.07s (transform 905ms, setup 121ms, import 1.38s, tests 8.56s, environment 1.57s)

