
[1m[46m RUN [49m[22m [36mv4.0.15 [39m[90mC:/Users/mooya/develop/test[39m

[90mstdout[2m | src/tests/StuckAndMarker.test.js[2m > [22m[2mStuck and Marker Debugging[2m > [22m[2mshould move IMMEDIATELY when assigned a job (no 3s delay)
[22m[39m[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:true isBusy:false force:false PassedGoblins:0
[Game] Request Added: move at (50,50) ID:req_0
[Game] forceAssignRequest FOUND Unit 0 (DistSq:3200). Scanned:1
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[JobState] smartMove failed(Wait).Budget ? 0 
[JobState] Entered.Target: move.Resume: UnitWanderState 
[Game] Force-Assigned Request req_0 to Unit 0 (Score: 3200.0)
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None
[Unit.js] ENTERED updateLogic. Dead=false
[Defense Debug 0] shouldScan:false isBusy:true force:true PassedGoblins:None

 [32mç¬¨ãƒ»[39m src/tests/StuckAndMarker.test.js [2m([22m[2m1 test[22m[2m)[22m[32m 35[2mms[22m[39m
[90mstdout[2m | src/tests/JobPathFailure.test.js[2m > [22m[2mJob Pathfinding Failure Handling[2m > [22m[2mshould abandon job if smartMove fails repeatedly
[22m[39m[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 99,0. Force:false
[Terrain] Building Added: cave at (99, 0) Size:1x1. Total: 1
GoblinManager: Cave registered at 99,0 
[GoblinManager] Clan clan_cave_99_0 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 158,111. Force:false
[Terrain] Building Added: cave at (158, 111) Size:1x1. Total: 2
GoblinManager: Cave registered at 158,111 
[GoblinManager] Clan clan_cave_158_111 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 64,150. Force:false
[Terrain] Building Added: cave at (64, 150) Size:1x1. Total: 3
GoblinManager: Cave registered at 64,150 
[GoblinManager] Clan clan_cave_64_150 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 119,13. Force:false
[Terrain] Building Added: cave at (119, 13) Size:1x1. Total: 4
GoblinManager: Cave registered at 119,13 
[GoblinManager] Clan clan_cave_119_13 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 7,140. Force:false
[Terrain] Building Added: cave at (7, 140) Size:1x1. Total: 5
GoblinManager: Cave registered at 7,140 
[GoblinManager] Clan clan_cave_7_140 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 25 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

[90mstdout[2m | src/tests/JobPathFailure.test.js[2m > [22m[2mJob Pathfinding Failure Handling[2m > [22m[2mshould abandon job if smartMove fails repeatedly
[22m[39m[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit 1] Moving onto Rock at 1,0 H:10 (Speed Penalty)
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] forceAssignRequest FAILED for Req 101. Scanned:1 (RoleSkipped:0) Busy:1 Valid:0. TotalUnits:1
[Defense Debug 1] shouldScan:true isBusy:false force:false PassedGoblins:None
[Defense Debug 1] shouldScan:true isBusy:false force:false PassedGoblins:None
[Defense Debug 1] shouldScan:true isBusy:false force:false PassedGoblins:None
[Defense Debug 1] shouldScan:true isBusy:false force:false PassedGoblins:None
[Defense Debug 1] shouldScan:true isBusy:false force:false PassedGoblins:None
Success: Job released after repeated failures.

 [32mç¬¨ãƒ»[39m src/tests/JobPathFailure.test.js [2m([22m[2m1 test[22m[2m)[22m[33m 2485[2mms[22m[39m
     [33m[2mç¬¨ãƒ»[22m[39m should abandon job if smartMove fails repeatedly [33m 2483[2mms[22m[39m
[90mstdout[2m | src/tests/JobIdempotency.test.js[2m > [22m[2mJob Assignment Idempotency[2m > [22m[2mshould NOT reset movement if claiming the same job twice
[22m[39m[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 145,85. Force:false
[Terrain] Building Added: cave at (145, 85) Size:1x1. Total: 1
GoblinManager: Cave registered at 145,85 
[GoblinManager] Clan clan_cave_145_85 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 47,150. Force:false
[Terrain] Building Added: cave at (47, 150) Size:1x1. Total: 2
GoblinManager: Cave registered at 47,150 
[GoblinManager] Clan clan_cave_47_150 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 54,130. Force:false
[Terrain] Building Added: cave at (54, 130) Size:1x1. Total: 3
GoblinManager: Cave registered at 54,130 
[GoblinManager] Clan clan_cave_54_130 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 46,39. Force:false
[Terrain] Building Added: cave at (46, 39) Size:1x1. Total: 4
GoblinManager: Cave registered at 46,39 
[GoblinManager] Clan clan_cave_46_39 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 78,121. Force:false
[Terrain] Building Added: cave at (78, 121) Size:1x1. Total: 5
GoblinManager: Cave registered at 78,121 
[GoblinManager] Clan clan_cave_78_121 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 9 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.

[90mstdout[2m | src/tests/JobIdempotency.test.js[2m > [22m[2mJob Assignment Idempotency[2m > [22m[2mshould NOT reset movement if claiming the same job twice
[22m[39m[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None

 [32mç¬¨ãƒ»[39m src/tests/JobIdempotency.test.js [2m([22m[2m1 test[22m[2m)[22m[33m 2595[2mms[22m[39m
     [33m[2mç¬¨ãƒ»[22m[39m should NOT reset movement if claiming the same job twice [33m 2593[2mms[22m[39m
[90mstdout[2m | src/tests/MultiJob.test.js[2m > [22m[2mMulti-Job Juggling Verification[2m > [22m[2mshould NOT interrupt busy units when a new job is added
[22m[39m[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 49,150. Force:false
[Terrain] Building Added: cave at (49, 150) Size:1x1. Total: 1
GoblinManager: Cave registered at 49,150 
[GoblinManager] Clan clan_cave_49_150 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 47,144. Force:false
[Terrain] Building Added: cave at (47, 144) Size:1x1. Total: 2
GoblinManager: Cave registered at 47,144 
[GoblinManager] Clan clan_cave_47_144 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 18,92. Force:false
[Terrain] Building Added: cave at (18, 92) Size:1x1. Total: 3
GoblinManager: Cave registered at 18,92 
[GoblinManager] Clan clan_cave_18_92 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 43,139. Force:false
[Terrain] Building Added: cave at (43, 139) Size:1x1. Total: 4
GoblinManager: Cave registered at 43,139 
[GoblinManager] Clan clan_cave_43_139 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 22,124. Force:false
[Terrain] Building Added: cave at (22, 124) Size:1x1. Total: 5
GoblinManager: Cave registered at 22,124 
[GoblinManager] Clan clan_cave_22_124 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 12 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

[90mstdout[2m | src/tests/MultiJob.test.js[2m > [22m[2mMulti-Job Juggling Verification[2m > [22m[2mshould NOT interrupt busy units when a new job is added
[22m[39m[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:2
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request 101 to Unit 1 (Score: 400.0)
[Game] forceAssignRequest FOUND Unit 2 (DistSq:400). Scanned:2
[Defense Debug 2] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request 102 to Unit 2 (Score: 400.0)
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Defense Debug 2] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Request Added: build at (10,10) ID:req_0
[Game] forceAssignRequest FAILED for Req req_0. Scanned:2 (RoleSkipped:0) Busy:2 Valid:0. TotalUnits:2
[Game] forceAssignRequest FAILED for Req req_0. Scanned:2 (RoleSkipped:0) Busy:2 Valid:0. TotalUnits:2

 [32mç¬¨ãƒ»[39m src/tests/MultiJob.test.js [2m([22m[2m1 test[22m[2m)[22m[33m 3183[2mms[22m[39m
     [33m[2mç¬¨ãƒ»[22m[39m should NOT interrupt busy units when a new job is added [33m 3180[2mms[22m[39m
[90mstdout[2m | src/tests/ComplexInteraction.test.js[2m > [22m[2mComplex Job Interaction and Cancellation[2m > [22m[2mshould immediately stop unit when job is cancelled mid-approach
[22m[39m[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:0,0
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 129,147. Force:false
[Terrain] Building Added: cave at (129, 147) Size:1x1. Total: 1
GoblinManager: Cave registered at 129,147 
[GoblinManager] Clan clan_cave_129_147 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 157,100. Force:false
[Terrain] Building Added: cave at (157, 100) Size:1x1. Total: 2
GoblinManager: Cave registered at 157,100 
[GoblinManager] Clan clan_cave_157_100 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 50,31. Force:false
[Terrain] Building Added: cave at (50, 31) Size:1x1. Total: 3
GoblinManager: Cave registered at 50,31 
[GoblinManager] Clan clan_cave_50_31 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 43,112. Force:false
[Terrain] Building Added: cave at (43, 112) Size:1x1. Total: 4
GoblinManager: Cave registered at 43,112 
[GoblinManager] Clan clan_cave_43_112 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 143,14. Force:false
[Terrain] Building Added: cave at (143, 14) Size:1x1. Total: 5
GoblinManager: Cave registered at 143,14 
[GoblinManager] Clan clan_cave_143_14 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 11 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

[90mstdout[2m | src/tests/ComplexInteraction.test.js[2m > [22m[2mComplex Job Interaction and Cancellation[2m > [22m[2mshould immediately stop unit when job is cancelled mid-approach
[22m[39m[Game] Request Added: build at (20,0) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 400.0)
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit 1] Moving onto Rock at 19,0 H:10 (Speed Penalty)
[Game] Cancelling active job for Unit 1
[Game] Request Canceled at 20,0 (Target: 20,0)
[Defense Debug 1] shouldScan:true isBusy:false force:false PassedGoblins:None
DEBUG: TargetRequest: [1mnull[22m
DEBUG: Queue Length: [33m0[39m

[90mstdout[2m | src/tests/ComplexInteraction.test.js[2m > [22m[2mComplex Job Interaction and Cancellation[2m > [22m[2mshould pickup NEXT job if current is cancelled
[22m[39m[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:0,0
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 37,90. Force:false
[Terrain] Building Added: cave at (37, 90) Size:1x1. Total: 1
GoblinManager: Cave registered at 37,90 
[GoblinManager] Clan clan_cave_37_90 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 20,114. Force:false
[Terrain] Building Added: cave at (20, 114) Size:1x1. Total: 2
GoblinManager: Cave registered at 20,114 
[GoblinManager] Clan clan_cave_20_114 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 67,152. Force:false
[Terrain] Building Added: cave at (67, 152) Size:1x1. Total: 3
GoblinManager: Cave registered at 67,152 
[GoblinManager] Clan clan_cave_67_152 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 53,70. Force:false
[Terrain] Building Added: cave at (53, 70) Size:1x1. Total: 4
GoblinManager: Cave registered at 53,70 
[GoblinManager] Clan clan_cave_53_70 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 8,122. Force:false
[Terrain] Building Added: cave at (8, 122) Size:1x1. Total: 5
GoblinManager: Cave registered at 8,122 
[GoblinManager] Clan clan_cave_8_122 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 9 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

[90mstdout[2m | src/tests/ComplexInteraction.test.js[2m > [22m[2mComplex Job Interaction and Cancellation[2m > [22m[2mshould pickup NEXT job if current is cancelled
[22m[39m[Game] Request Added: build at (20,0) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 400.0)
[Game] Request Added: build at (-20,0) ID:req_1
[Game] forceAssignRequest FAILED for Req req_1. Scanned:1 (RoleSkipped:0) Busy:1 Valid:0. TotalUnits:1
[Game] forceAssignRequest FAILED for Req req_1. Scanned:1 (RoleSkipped:0) Busy:1 Valid:0. TotalUnits:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit 1] Moving onto Rock at 19,0 H:10 (Speed Penalty)
[Game] Cancelling active job for Unit 1
[Game] Request Canceled at 20,0 (Target: 20,0)
[Defense Debug 1] shouldScan:true isBusy:false force:false PassedGoblins:None
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit 1] Moving onto Rock at 19,0 H:10 (Speed Penalty)

[90mstdout[2m | src/tests/ComplexInteraction.test.js[2m > [22m[2mComplex Job Interaction and Cancellation[2m > [22m[2mshould handle cancellation while Working (arrived)
[22m[39m[UnitCore.js] Unit Created ID:2 Role:worker Pos:0,0 Special:false
[UnitCore.js] Unit Created ID:2 Role:worker Pos:0,0
SheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
[Terrain] addBuilding: cave at 29,9. Force:false
[Terrain] Building Added: cave at (29, 9) Size:1x1. Total: 1
GoblinManager: Cave registered at 29,9 
[GoblinManager] Clan clan_cave_29_9 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 144,21. Force:false
[Terrain] Building Added: cave at (144, 21) Size:1x1. Total: 2
GoblinManager: Cave registered at 144,21 
[GoblinManager] Clan clan_cave_144_21 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 85,101. Force:false
[Terrain] Building Added: cave at (85, 101) Size:1x1. Total: 3
GoblinManager: Cave registered at 85,101 
[GoblinManager] Clan clan_cave_85_101 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 95,61. Force:false
[Terrain] Building Added: cave at (95, 61) Size:1x1. Total: 4
GoblinManager: Cave registered at 95,61 
[GoblinManager] Clan clan_cave_95_61 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
[Terrain] addBuilding: cave at 5,16. Force:false
[Terrain] Building Added: cave at (5, 16) Size:1x1. Total: 5
GoblinManager: Cave registered at 5,16 
[GoblinManager] Clan clan_cave_5_16 ACTIVATED! Wave 1 in 30s. Target: [1mnull[22m
GoblinManager: Generated 5 goblin caves after 12 attempts.
GoblinManager: Force spawning Debug Goblin
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.
Tower Geometry Initialized (Split Mode)
Tower Debug: Generated High-Res Tower Texture + Cap Material

[90mstdout[2m | src/tests/ComplexInteraction.test.js[2m > [22m[2mComplex Job Interaction and Cancellation[2m > [22m[2mshould handle cancellation while Working (arrived)
[22m[39m[Game] Request Added: build at (20,0) ID:req_0
[Game] forceAssignRequest FOUND Unit 1 (DistSq:400). Scanned:1
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Game] Force-Assigned Request req_0 to Unit 1 (Score: 400.0)
[Defense Debug 1] shouldScan:false isBusy:true force:false PassedGoblins:None
[Unit 1] Moving onto Rock at 19,0 H:10 (Speed Penalty)

 [32mç¬¨ãƒ»[39m src/tests/ComplexInteraction.test.js [2m([22m[2m3 tests[22m[2m)[22m[33m 8949[2mms[22m[39m
     [33m[2mç¬¨ãƒ»[22m[39m should immediately stop unit when job is cancelled mid-approach [33m 3222[2mms[22m[39m
     [33m[2mç¬¨ãƒ»[22m[39m should pickup NEXT job if current is cancelled [33m 3038[2mms[22m[39m
     [33m[2mç¬¨ãƒ»[22m[39m should handle cancellation while Working (arrived) [33m 2685[2mms[22m[39m

[2m Test Files [22m [1m[32m5 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[32m7 passed[39m[22m[90m (7)[39m
[2m   Start at [22m 14:39:43
[2m   Duration [22m 11.08s[2m (transform 1.96s, setup 267ms, import 3.28s, tests 17.25s, environment 4.26s)[22m

