
[1m[46m RUN [49m[22m [36mv4.0.15 [39m[90mC:/Users/mooya/develop/test[39m

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39mSheepManager Refactored: Initialized with Entity-based Sheep.
GoblinManager: Generation started...
GoblinManager: Generated 0 goblin caves after 5000 attempts.
Spawned initial fish.
FishManager Refactored: Initialized with Entity-based Fish.

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[UnitCore.js] Unit Created ID:0 Role:worker Pos:2,2 Special:false
[UnitCore.js] Unit Created ID:0 Role:worker Pos:2,2
[Game] Request Added: raise at (10,10) ID:req_0
[Assign] Checking Unit 0 (Dead:false)
[Assign] Unit 0 Action: Idle, TargetReq: none
[Game] forceAssignRequest FOUND Unit 0 (DistSq:128). Scanned:1
[JobState] Entered. Target: raise. ResumeCtx: Approaching Job
[Game] Request req_0 assigned/switched to Unit 0
[UnitCore.js] Unit Created ID:1 Role:worker Pos:2,2 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:2,2
[Game] Request Added: raise at (10,10) ID:req_1
[Assign] Checking Unit 0 (Dead:false)
[Assign] Unit 0 Action: Approaching Job, TargetReq: req_0
[Assign] Checking Unit 1 (Dead:false)
[Assign] Unit 1 Action: Idle, TargetReq: none
[Game] forceAssignRequest FOUND Unit 1 (DistSq:128). Scanned:2
[Game] Request req_1 assigned/switched to Unit 1
[UnitCore.js] Unit Created ID:2 Role:worker Pos:2,2 Special:false
[UnitCore.js] Unit Created ID:2 Role:worker Pos:2,2
[Game] Request Added: raise at (10,10) ID:req_2
[Assign] Checking Unit 0 (Dead:false)
[Assign] Unit 0 Action: Approaching Job, TargetReq: req_0
[Assign] Checking Unit 1 (Dead:false)
[Assign] Unit 1 Action: Approaching Job, TargetReq: req_1
[Assign] Checking Unit 2 (Dead:false)
[Assign] Unit 2 Action: Idle, TargetReq: none
[Game] forceAssignRequest FOUND Unit 2 (DistSq:128). Scanned:3
[Game] Request req_2 assigned/switched to Unit 2
[UnitCore.js] Unit Created ID:3 Role:worker Pos:2,2 Special:false
[UnitCore.js] Unit Created ID:3 Role:worker Pos:2,2
[Game] Request Added: raise at (10,10) ID:req_3
[Assign] Checking Unit 0 (Dead:false)
[Assign] Unit 0 Action: Approaching Job, TargetReq: req_0
[Assign] Checking Unit 1 (Dead:false)
[Assign] Unit 1 Action: Approaching Job, TargetReq: req_1
[Assign] Checking Unit 2 (Dead:false)
[Assign] Unit 2 Action: Approaching Job, TargetReq: req_2
[Assign] Checking Unit 3 (Dead:false)
[Assign] Unit 3 Action: Idle, TargetReq: none
[Game] forceAssignRequest FOUND Unit 3 (DistSq:128). Scanned:4
[Game] Request req_3 assigned/switched to Unit 3
[UnitCore.js] Unit Created ID:4 Role:worker Pos:2,2 Special:false
[UnitCore.js] Unit Created ID:4 Role:worker Pos:2,2
[Game] Request Added: raise at (10,10) ID:req_4
[Assign] Checking Unit 0 (Dead:false)
[Assign] Unit 0 Action: Approaching Job, TargetReq: req_0
[Assign] Checking Unit 1 (Dead:false)
[Assign] Unit 1 Action: Approaching Job, TargetReq: req_1
[Assign] Checking Unit 2 (Dead:false)
[Assign] Unit 2 Action: Approaching Job, TargetReq: req_2
[Assign] Checking Unit 3 (Dead:false)
[Assign] Unit 3 Action: Approaching Job, TargetReq: req_3
[Assign] Checking Unit 4 (Dead:false)
[Assign] Unit 4 Action: Idle, TargetReq: none
[Game] forceAssignRequest FOUND Unit 4 (DistSq:128). Scanned:5
[Game] Request req_4 assigned/switched to Unit 4
[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50
[Stress Test] Frame 0. Moved: 0/5. BudgetCalls: 0
[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Stress Test] Frame 10. Moved: 0/5. BudgetCalls: 0

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Stress Test] Frame 20. Moved: 0/5. BudgetCalls: 0

[90mstdout[2m | src/tests/UnitStress.test.js[2m > [22m[2mUnit AI Stress Testing[2m > [22m[2mshould eventually reach target even with extreme congestion (low budget)
[22m[39m[Actor] Discarding stale path. Target changed to 10,10 from 50,50

 [31mç¬¶ï½¯[39m src/tests/UnitStress.test.js [2m([22m[2m2 tests[22m[2m | [22m[31m1 failed[39m[2m | [22m[33m1 skipped[39m[2m)[22m[32m 186[2mms[22m[39m
     [2m[90mç«Šãƒ»[39m[22m should handle 100 units starting distant jobs simultaneously without dropping tasks
[31m     [31mï¾ƒãƒ»[31m should eventually reach target even with extreme congestion (low budget)[39m[32m 184[2mms[22m[39m

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ Failed Tests 1 ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯

 FAIL  src/tests/UnitStress.test.js > Unit AI Stress Testing > should eventually reach target even with extreme congestion (low budget)
TypeError: this.terrain.findBestTarget is not a function
 ç¬¶ï½¯ Unit.checkSelfDefense src/Unit.js:657:46
    655| 
    656|             // Use findBestTarget to avoid O(N) loop over all goblins
    657|             const foundGoblin = this.terrain.findBestTarget('goblin', çª¶ï½¦
       |                                              ^
    658|                 if (g.isDead) return Infinity;
    659|                 if (this.ignoredTargets.has(g.id)) return Infinity;
 ç¬¶ï½¯ JobState.update src/ai/states/UnitStates.js:300:59
 ç¬¶ï½¯ Unit.updateLogic src/Unit.js:1718:24
 ç¬¶ï½¯ src/tests/UnitStress.test.js:151:19
 ç¬¶ï½¯ src/tests/UnitStress.test.js:133:19

ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯ç«¡ï½¯[1/1]ç«¡ï½¯


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[33m1 skipped[39m[90m (2)[39m
[2m   Start at [22m 12:26:00
[2m   Duration [22m 2.08s[2m (transform 562ms, setup 79ms, import 715ms, tests 186ms, environment 716ms)[22m

