
 RUN  v4.0.15 C:/Users/mooya/develop/test

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should immediately switch to Job and target the job upon assignment
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should immediately switch to Job and target the job upon assignment
[Unit 0] State Change: Wander -> Wander
[Test] Assigning request...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 10.0 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:false Path:2
[Actor 0] SmartMove Depth:1 Node:10,10 My:10,10 d:0,0
[Actor 0] Reached Node. Shifting.
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:false Path:1
[Actor 0] SmartMove Depth:2 Node:20,10 My:10,10 d:10,0
[Entity 0] startMove -> isMoving:true. Target:20,10 StartTime:0.0000
[Test] Update Frame 1...
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:true Path:1
[Actor 0] SmartMove Depth:0 Node:20,10 My:10,10 d:10,0
[Test] Unit Moving? true Target: 20,10

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT be distracted by WanderState updates during Job
[Entity 1] Calling updatePosition...
[Entity 1] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:1 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:10,10

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT be distracted by WanderState updates during Job
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 10.0 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:false Path:2
[Actor 0] SmartMove Depth:1 Node:10,10 My:10,10 d:0,0
[Actor 0] Reached Node. Shifting.
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:false Path:1
[Actor 0] SmartMove Depth:2 Node:20,10 My:10,10 d:10,0
[Entity 0] startMove -> isMoving:true. Target:20,10 StartTime:0.0000
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:true Path:1
[Actor 0] SmartMove Depth:0 Node:20,10 My:10,10 d:10,0
[Actor 0] smartMove to 20,10 (H:1). Reachable:true Dist:10.00 Moving:true Path:1
[Actor 0] SmartMove Depth:0 Node:20,10 My:10,10 d:10,0

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should not freeze due to throttle at low game time
[Entity 2] Calling updatePosition...
[Entity 2] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:2 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:2 Role:worker Pos:10,10

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should not freeze due to throttle at low game time
[Unit 0] State Change: Wander -> Wander
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 50,50 (H:1). Reachable:true Dist:56.57 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 56.6 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[Actor 0] smartMove to 50,50 (H:1). Reachable:true Dist:56.57 Moving:false Path:2
[Actor 0] SmartMove Depth:1 Node:10,10 My:10,10 d:0,0
[Actor 0] Reached Node. Shifting.
[Actor 0] smartMove to 50,50 (H:1). Reachable:true Dist:56.57 Moving:false Path:1
[Actor 0] SmartMove Depth:2 Node:50,50 My:10,10 d:40,40
[Entity 0] startMove -> isMoving:true. Target:50,50 StartTime:0.0000

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT build a house immediately if pathfinding fails temporarily
[Entity 3] Calling updatePosition...
[Entity 3] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:3 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:3 Role:worker Pos:10,10

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT build a house immediately if pathfinding fails temporarily
[Unit 0] State Change: Wander -> Job
[Unit 0] State Change: Job -> Wander

stdout | src/tests/GoblinEncounter.test.js > Goblin Encounter Logic > Goblin should detect Worker within range and enter Combat
Goblin constructor: calling super...
[Entity 0] Calling registerEntity...
[Entity 0] registerEntity returned.
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 20,20
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Actor 0] CHANGE STATE: None -> Wander Request:null
[Entity 1] Calling registerEntity...
[Entity 1] registerEntity returned.
[Entity 1] Calling updatePosition...
[Entity 1] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 30,20
[UnitCore.js] Unit Created ID:0 Role:worker Pos:30,20 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:30,20
[Test Debug 1] Target: None, State: Wander
[GoblinState Debug] ID:100 Calling scanForTargets...
[Goblin 100] Found Unit Candidate: 200 Dist:?
[Test Debug 2] Target: 200, State: Combat

stdout | src/tests/GoblinEncounter.test.js > Goblin Encounter Logic > Goblin should prioritize Worker if Building is far, or attack Building if close
Goblin constructor: calling super...
[Entity 2] Calling registerEntity...
[Entity 2] registerEntity returned.
[Entity 2] Calling updatePosition...
[Entity 2] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 20,20
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Entity 3] Calling registerEntity...
[Entity 3] registerEntity returned.
[Entity 3] Calling updatePosition...
[Entity 3] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 30,20
[UnitCore.js] Unit Created ID:1 Role:worker Pos:30,20 Special:false
[UnitCore.js] Unit Created ID:1 Role:worker Pos:30,20
[Goblin 101] Found Unit Candidate: 201 Dist:?
[Actor 101] smartMove: triggers pathfinding. Dist: 10.0 Time:0.7 Last:0.0 Throttle:1.10 Action:Fighting
[Actor 101] smartMove: triggers pathfinding. Dist: 10.0 Time:1.8 Last:0.7 Throttle:1.10 Action:Fighting
[Actor 101] smartMove: triggers pathfinding. Dist: 10.0 Time:2.9 Last:1.8 Throttle:1.10 Action:Fighting
[Actor 101] smartMove: triggers pathfinding. Dist: 10.0 Time:4.0 Last:2.9 Throttle:1.10 Action:Fighting
[Test Debug Priority] Target: 201, BTarget: None, State: Combat

stdout | src/tests/GoblinEncounter.test.js > Goblin Encounter Logic > Goblin should switch target to Worker if it encounters one while moving to a far Building
Goblin constructor: calling super...
[Entity 4] Calling registerEntity...
[Entity 4] registerEntity returned.
[Entity 4] Calling updatePosition...
[Entity 4] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 20,20
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Entity 5] Calling registerEntity...
[Entity 5] registerEntity returned.
[Entity 5] Calling updatePosition...
[Entity 5] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 25,20
[UnitCore.js] Unit Created ID:2 Role:worker Pos:25,20 Special:false
[UnitCore.js] Unit Created ID:2 Role:worker Pos:25,20
[Goblin 102] Found Unit Candidate: 202 Dist:?
[Actor 102] smartMove: triggers pathfinding. Dist: 5.0 Time:2.0 Last:0.0 Throttle:1.20 Action:Fighting
[Actor 102] smartMove: triggers pathfinding. Dist: 5.0 Time:3.5 Last:2.0 Throttle:1.20 Action:Fighting
[Actor 102] smartMove: triggers pathfinding. Dist: 5.0 Time:5.0 Last:3.5 Throttle:1.20 Action:Fighting
[Actor 102] smartMove: triggers pathfinding. Dist: 5.0 Time:6.5 Last:5.0 Throttle:1.20 Action:Fighting
[Actor 102] smartMove: triggers pathfinding. Dist: 5.0 Time:8.0 Last:6.5 Throttle:1.20 Action:Fighting
[Actor 102] smartMove: triggers pathfinding. Dist: 5.0 Time:9.5 Last:8.0 Throttle:1.20 Action:Fighting
[Test Debug Switch] Target: 202, BTarget: None, State: Combat

 âœ“ src/tests/GoblinEncounter.test.js > Goblin Encounter Logic > Goblin should detect Worker within range and enter Combat 14ms
 âœ“ src/tests/GoblinEncounter.test.js > Goblin Encounter Logic > Goblin should prioritize Worker if Building is far, or attack Building if close 6ms
 âœ“ src/tests/GoblinEncounter.test.js > Goblin Encounter Logic > Goblin should switch target to Worker if it encounters one while moving to a far Building 4ms
stdout | src/tests/ComplexAI.test.js
[Import Debug] Raid: function, Combat: function, Wander: function

stdout | src/tests/CombatBalance.test.js
[Import Debug] Raid: function, Combat: function, Wander: function

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT build a house immediately if pathfinding fails temporarily
[Unit 0] State Change: Wander -> Build

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Worker vs Normal Goblin (Expected: Goblin Win due to stats buff)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.055694, 0.774848) -> Grid(8, 123) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.770604, 0.686813) -> Grid(123, 109) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.676381, 0.327539) -> Grid(108, 52) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.452642, 0.958505) -> Grid(72, 153) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.302260, 0.422941) -> Grid(48, 67) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.870311, 0.529595) -> Grid(139, 84) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should drop job gracefully if target building is destroyed
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.650329, 0.085487) -> Grid(104, 13) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.453783, 0.114877) -> Grid(72, 18) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.922293, 0.022094) -> Grid(147, 3) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Worker vs Normal Goblin (Expected: Goblin Win due to stats buff)
[Entity 0] Calling registerEntity...
[Entity 0] registerEntity returned.
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
Goblin constructor: calling super...
[Entity 1] Calling registerEntity...
[Entity 1] registerEntity returned.
[Entity 1] Calling updatePosition...
[Entity 1] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Actor 0] CHANGE STATE: None -> Wander Request:null
[Unit 0] State Change: Wander -> Combat
[Unit Debug] ATTACKING Goblin 0
[Actor 0] CHANGE STATE: Wander -> Combat Request:null
Goblin hit Unit! Dmg: 15 UnitHP: 47 
[Unit Debug] ATTACKING Goblin 0
Goblin hit Unit! Dmg: 15 UnitHP: 32.03360000000022 
[Unit Debug] ATTACKING Goblin 0
Goblin hit Unit! Dmg: 15 UnitHP: 17.06720000000044 
[Unit Debug] ATTACKING Goblin 0
Goblin hit Unit! Dmg: 15 UnitHP: 2.1008000000006604 
[Unit Debug] ATTACKING Goblin 0
[Goblin 0] Death Counter! Hitting 0
Unit 0 (worker) DIED. R.I.P.
Goblin(normal) died.ID:0 
[Worker vs Normal]
 Start: Unit(worker HP:62/62 Dmg:12) vs Goblin(normal HP:50/50 Dmg:15)
End: Winner=Goblin Frames=254
Final: Unit HP:0.0 Goblin HP:0.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Worker vs Normal Goblin (Expected: Goblin Win due to stats buff)
[Game] Dispose called for Game Instance.

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should drop job gracefully if target building is destroyed
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Game] Request Added: cultivate at (20,20) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 20,20 (H:5). Reachable:true Dist:14.14 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 14.1 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[ComplexAI Debug 1] State: Job
[UnitState Job] Target b_1 destroyed. Exiting Job.
[Unit 0] State Change: Job -> Wander
[Actor 0] smartMove to 20,20 (H:5). Reachable:true Dist:14.14 Moving:false Path:1
[Actor 0] SmartMove Depth:1 Node:20,20 My:10,10 d:10,10
[Entity 0] startMove -> isMoving:true. Target:20,20 StartTime:0.0000

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Normal Goblin vs House (Expected: Mutually Assured Destruction or House Defense)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.642872, 0.293780) -> Grid(102, 47) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.208203, 0.541554) -> Grid(33, 86) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.323625, 0.736116) -> Grid(51, 117) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.478961, 0.130347) -> Grid(76, 20) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.912539, 0.936690) -> Grid(146, 149) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.375159, 0.273506) -> Grid(60, 43) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Normal Goblin vs House (Expected: Mutually Assured Destruction or House Defense)
Goblin constructor: calling super...
[Entity 2] Calling registerEntity...
[Entity 2] registerEntity returned.
[Entity 2] Calling updatePosition...
[Entity 2] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
Check updateCombatLogic: function
Goblin Raid: House population reduced.Rem: 9 
Goblin Raid: House population reduced.Rem: 8 
Goblin(normal) died.ID:1 
[Goblin vs House]
 Start: Goblin vs House (Pop:10)
End: Goblin Dead=true House Pop=8 Frames=64

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Normal Goblin vs House (Expected: Mutually Assured Destruction or House Defense)
[Game] Dispose called for Game Instance.

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs Normal Goblin (Expected: Knight Stomp)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.802891, 0.385163) -> Grid(128, 61) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.878501, 0.275081) -> Grid(140, 44) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.717035, 0.886928) -> Grid(114, 141) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.868061, 0.358612) -> Grid(138, 57) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.458346, 0.291085) -> Grid(73, 46) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.120365, 0.915364) -> Grid(19, 146) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs Normal Goblin (Expected: Knight Stomp)
[Entity 3] Calling registerEntity...
[Entity 3] registerEntity returned.
[Entity 3] Calling updatePosition...
[Entity 3] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:1 Role:knight Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:1 Role:knight Pos:10,10
Goblin constructor: calling super...
[Entity 4] Calling registerEntity...
[Entity 4] registerEntity returned.
[Entity 4] Calling updatePosition...
[Entity 4] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Unit Debug] ATTACKING Goblin 2
[Goblin 2] Death Counter! Hitting 1
Goblin(normal) died.ID:2 
[Game] New Battle Hotspot at 10,10 (Region:[object Object])
[Knight vs Normal]
 Start: Unit(knight HP:1007/1007 Dmg:300) vs Goblin(normal HP:50/50 Dmg:15)
End: Winner=Unit Frames=2
Final: Unit HP:999.5 Goblin HP:0.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs Normal Goblin (Expected: Knight Stomp)
[Game] Dispose called for Game Instance.

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should prioritize manual jobs even when closer auto jobs appear
[Game] Dispose called for Game Instance.
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.669761, 0.228639) -> Grid(107, 36) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.939311, 0.253545) -> Grid(150, 40) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.633462, 0.450573) -> Grid(101, 72) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should prioritize manual jobs even when closer auto jobs appear
[Entity 1] Calling updatePosition...
[Entity 1] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Game] Request Added: raise at (50,50) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 50,50 (H:5). Reachable:true Dist:56.57 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 56.6 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[Game] Request Added: raise at (11,11) ID:req_1
[Actor 0] smartMove to 50,50 (H:5). Reachable:true Dist:56.57 Moving:false Path:1
[Actor 0] SmartMove Depth:1 Node:50,50 My:10,10 d:40,40
[Entity 0] startMove -> isMoving:true. Target:50,50 StartTime:0.0000

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs King Goblin (Expected: Close or King Advantage)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.277020, 0.651616) -> Grid(44, 104) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.027197, 0.478179) -> Grid(4, 76) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.273384, 0.292486) -> Grid(43, 46) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.721156, 0.255988) -> Grid(115, 40) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.682619, 0.146062) -> Grid(109, 23) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.152423, 0.852132) -> Grid(24, 136) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs King Goblin (Expected: Close or King Advantage)
[Entity 5] Calling registerEntity...
[Entity 5] registerEntity returned.
[Entity 5] Calling updatePosition...
[Entity 5] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:2 Role:knight Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:2 Role:knight Pos:10,10
Goblin constructor: calling super...
[Entity 6] Calling registerEntity...
[Entity 6] registerEntity returned.
[Entity 6] Calling updatePosition...
[Entity 6] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Unit Debug] ATTACKING Goblin 3
[Game] New Battle Hotspot at 10,10 (Region:[object Object])
Goblin hit Unit! Dmg: 80 UnitHP: 925 
[Unit Debug] ATTACKING Goblin 3
Goblin hit Unit! Dmg: 80 UnitHP: 845.0400000000013 
[Unit Debug] ATTACKING Goblin 3
Goblin hit Unit! Dmg: 80 UnitHP: 765.0800000000027 
[Unit Debug] ATTACKING Goblin 3
Goblin hit Unit! Dmg: 80 UnitHP: 685.120000000004 
[Unit Debug] ATTACKING Goblin 3
Goblin hit Unit! Dmg: 80 UnitHP: 605.1600000000053 
[Unit Debug] ATTACKING Goblin 3
[Goblin 3] Death Counter! Hitting 2
Goblin(king) died.ID:3 
King Defeated! +500 Mana
[Knight vs King]
 Start: Unit(knight HP:1005/1005 Dmg:300) vs Goblin(king HP:1521/1521 Dmg:80)
End: Winner=Unit Frames=317
Final: Unit HP:565.2 Goblin HP:0.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs King Goblin (Expected: Close or King Advantage)
[Game] Dispose called for Game Instance.

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Wizard vs Hobgoblin (Expected: Wizard High DPS but Fragile)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.319294, 0.410681) -> Grid(51, 65) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.558839, 0.403989) -> Grid(89, 64) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.436857, 0.237570) -> Grid(69, 38) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.711409, 0.370893) -> Grid(113, 59) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.251785, 0.048797) -> Grid(40, 7) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.783621, 0.081930) -> Grid(125, 13) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should prioritize manual jobs even when closer auto jobs appear
[Actor 0] SmartMove Depth:0 Node:50,50 My:10,10 d:40,40

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Wizard vs Hobgoblin (Expected: Wizard High DPS but Fragile)
[Entity 7] Calling registerEntity...
[Entity 7] registerEntity returned.
[Entity 7] Calling updatePosition...
[Entity 7] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:3 Role:wizard Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:3 Role:wizard Pos:10,10
Goblin constructor: calling super...
[Entity 8] Calling registerEntity...
[Entity 8] registerEntity returned.
[Entity 8] Calling updatePosition...
[Entity 8] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Unit Debug] ATTACKING Goblin 4
[Goblin 4] Death Counter! Hitting 3
Goblin(hobgoblin) died.ID:4 
[Game] New Battle Hotspot at 10,10 (Region:[object Object])
[Wizard vs Hobgoblin]
 Start: Unit(wizard HP:163/163 Dmg:240) vs Goblin(hobgoblin HP:150/150 Dmg:30)
End: Winner=Unit Frames=2
Final: Unit HP:148.0 Goblin HP:0.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Wizard vs Hobgoblin (Expected: Wizard High DPS but Fragile)
[Game] Dispose called for Game Instance.

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT build a house immediately if pathfinding fails temporarily
[Unit 0] State Change: Build -> Wander

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Goblin King should crush Worker
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.569307, 0.912068) -> Grid(91, 145) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.189629, 0.098569) -> Grid(30, 15) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.091417, 0.492065) -> Grid(14, 78) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.483368, 0.206079) -> Grid(77, 32) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.077204, 0.725910) -> Grid(12, 116) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.417808, 0.002864) -> Grid(66, 0) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT build a house immediately if pathfinding fails temporarily
[Unit 0] State Change: Wander -> Build

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Goblin King should crush Worker
[Entity 9] Calling registerEntity...
[Entity 9] registerEntity returned.
[Entity 9] Calling updatePosition...
[Entity 9] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:4 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:4 Role:worker Pos:10,10
Goblin constructor: calling super...
[Entity 10] Calling registerEntity...
[Entity 10] registerEntity returned.
[Entity 10] Calling updatePosition...
[Entity 10] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
Worker HP: 51, Dmg: 12
King HP: 1590, Dmg: 80
[Unit Debug] ATTACKING Goblin 5
[Unit 4] Death Counter! Hitting 5
Unit 4 (worker) DIED. R.I.P.
Goblin hit Unit! Dmg: 80 UnitHP: 0 
[Worker vs King]
 Start: Unit(worker HP:51/51 Dmg:12) vs Goblin(king HP:1590/1590 Dmg:80)
End: Winner=Goblin Frames=33
Final: Unit HP:0.0 Goblin HP:1572.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Goblin King should crush Worker
[Game] Dispose called for Game Instance.

 âœ“ src/tests/CombatBalance.test.js > Combat Balance Verification > Worker vs Normal Goblin (Expected: Goblin Win due to stats buff) 16ms
 âœ“ src/tests/CombatBalance.test.js > Combat Balance Verification > Normal Goblin vs House (Expected: Mutually Assured Destruction or House Defense) 5ms
 âœ“ src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs Normal Goblin (Expected: Knight Stomp) 5ms
 âœ“ src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs King Goblin (Expected: Close or King Advantage) 6ms
 âœ“ src/tests/CombatBalance.test.js > Combat Balance Verification > Wizard vs Hobgoblin (Expected: Wizard High DPS but Fragile) 4ms
 âœ“ src/tests/CombatBalance.test.js > Combat Balance Verification > Goblin King should crush Worker 4ms
stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should NOT drop manual job when switching to Sleep at night
[Game] Dispose called for Game Instance.
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.681124, 0.948437) -> Grid(108, 151) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.228879, 0.871831) -> Grid(36, 139) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.329457, 0.369866) -> Grid(52, 59) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should NOT drop manual job when switching to Sleep at night
[Entity 2] Calling updatePosition...
[Entity 2] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Game] Request Added: raise at (50,50) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 50,50 (H:5). Reachable:true Dist:56.57 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 56.6 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should NOT drop manual job when switching to Sleep at night
[Actor 0] smartMove to 50,50 (H:5). Reachable:true Dist:56.57 Moving:false Path:1
[Actor 0] SmartMove Depth:1 Node:50,50 My:10,10 d:40,40
[Entity 0] startMove -> isMoving:true. Target:50,50 StartTime:0.0000

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should abandon unreachable job (Abandonment Test)
[Game] Dispose called for Game Instance.
[GoblinManager] 5å€‹ã®æ´žçªŸã‚’ç”Ÿæˆä¸­...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.089751, 0.249348) -> Grid(14, 39) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.436842, 0.827850) -> Grid(69, 132) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.228075, 0.601461) -> Grid(36, 96) rngState=undefined
[GoblinManager] æ´žçªŸç”Ÿæˆå®Œäº†: 0/5 (è©¦è¡Œå›žæ•°: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should abandon unreachable job (Abandonment Test)
[Entity 3] Calling updatePosition...
[Entity 3] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Game] Request Added: raise at (90,90) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 90,90 (H:5). Reachable:true Dist:28.28 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 28.3 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[Game] Request req_0 Deferred (Excluded) for 3s until 3.1
[Unit 0] State Change: Job -> Wander

 âœ“ src/tests/ComplexAI.test.js > Complex AI Scenarios > should drop job gracefully if target building is destroyed 19ms
 âœ“ src/tests/ComplexAI.test.js > Complex AI Scenarios > should prioritize manual jobs even when closer auto jobs appear 16ms
 âœ“ src/tests/ComplexAI.test.js > Complex AI Scenarios > should NOT drop manual job when switching to Sleep at night 10ms
 âœ“ src/tests/ComplexAI.test.js > Complex AI Scenarios > should abandon unreachable job (Abandonment Test) 5ms
 âœ“ src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should immediately switch to Job and target the job upon assignment 6ms
 âœ“ src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT be distracted by WanderState updates during Job 3ms
 âœ“ src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should not freeze due to throttle at low game time 2ms
 Ã— src/tests/WorkerDistraction.test.js > Worker Distraction Investigation > should NOT build a house immediately if pathfinding fails temporarily 181ms
   â†’ expected "vi.fn()" to not be called at all, but actually been called 1 times[90m

Received: 

[1m  1st vi.fn() call:

[22m    Array [
      111.1,
    ]
[39m[90m

Number of calls: [1m1[22m
[39m

 Test Files  1 failed | 3 passed (4)
      Tests  1 failed | 16 passed (17)
   Start at  21:18:01
   Duration  1.39s (transform 1.24s, setup 304ms, import 1.54s, tests 312ms, environment 2.19s)

