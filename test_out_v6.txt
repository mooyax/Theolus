
 RUN  v4.0.15 C:/Users/mooya/develop/test

stdout | src/tests/CombatBalance.test.js
[Import Debug] Raid: function, Combat: function, Wander: function

stdout | src/tests/ComplexAI.test.js
[Import Debug] Raid: function, Combat: function, Wander: function

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Worker vs Normal Goblin (Expected: Goblin Win due to stats buff)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.868086, 0.365030) -> Grid(138, 58) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.876558, 0.676095) -> Grid(140, 108) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.855350, 0.348556) -> Grid(136, 55) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.681489, 0.506937) -> Grid(109, 81) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.222654, 0.305859) -> Grid(35, 48) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.951943, 0.698174) -> Grid(152, 111) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should drop job gracefully if target building is destroyed
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.965840, 0.126121) -> Grid(154, 20) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.825111, 0.306581) -> Grid(132, 49) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.809599, 0.613598) -> Grid(129, 98) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Worker vs Normal Goblin (Expected: Goblin Win due to stats buff)
[Entity 0] Calling registerEntity...
[Entity 0] registerEntity returned.
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
Goblin constructor: calling super...
[Entity 1] Calling registerEntity...
[Entity 1] registerEntity returned.
[Entity 1] Calling updatePosition...
[Entity 1] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
[Actor 0] CHANGE STATE: None -> Wander Request:null
[Unit 0] State Change: Wander -> Combat
[GoblinWander Debug] ID:0 State:Wander Update. Timer:0.05 dt:0.0160 findTarget:function
[GoblinWander Debug] ID:0 State:Wander Update. Timer:0.45 dt:0.0160 findTarget:function
[GoblinState Debug] ID:0 Calling scanForTargets...
[Actor 0] CHANGE STATE: Wander -> Combat Request:null
Goblin hit Unit! Dmg: 15 UnitHP: 40 
Goblin hit Unit! Dmg: 15 UnitHP: 25.03360000000022 
Goblin hit Unit! Dmg: 15 UnitHP: 10.06720000000044 
[Unit 0] Death Counter! Hitting 0
Unit 0 (worker) DIED. R.I.P.
Goblin hit Unit! Dmg: 15 UnitHP: 0 
[Worker vs Normal]
 Start: Unit(worker HP:55/55 Dmg:12) vs Goblin(normal HP:50/50 Dmg:15)
End: Winner=Goblin Frames=222
Final: Unit HP:0.0 Goblin HP:44.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Worker vs Normal Goblin (Expected: Goblin Win due to stats buff)
[Game] Dispose called for Game Instance.

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should drop job gracefully if target building is destroyed
[Entity 0] Calling updatePosition...
[Entity 0] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Game] Request Added: cultivate at (20,20) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 20,20 (H:5). Reachable:true Dist:14.14 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 14.1 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[ComplexAI Debug 1] State: Job
[Actor 0] smartMove to 20,20 (H:5). Reachable:true Dist:14.14 Moving:false Path:1
[Actor 0] SmartMove Depth:1 Node:20,20 My:10,10 d:10,10
[Entity 0] startMove -> isMoving:true. Target:20,20 StartTime:0.0000

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should prioritize manual jobs even when closer auto jobs appear
[Game] Dispose called for Game Instance.
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.676324, 0.257005) -> Grid(108, 41) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.709995, 0.039628) -> Grid(113, 6) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.683822, 0.963888) -> Grid(109, 154) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should prioritize manual jobs even when closer auto jobs appear
[Entity 1] Calling updatePosition...
[Entity 1] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Game] Request Added: raise at (50,50) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 50,50 (H:5). Reachable:true Dist:56.57 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 56.6 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[Game] Request Added: raise at (11,11) ID:req_1
[Actor 0] smartMove to 50,50 (H:5). Reachable:true Dist:56.57 Moving:false Path:1
[Actor 0] SmartMove Depth:1 Node:50,50 My:10,10 d:40,40
[Entity 0] startMove -> isMoving:true. Target:50,50 StartTime:0.0000

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should prioritize manual jobs even when closer auto jobs appear
[Actor 0] SmartMove Depth:0 Node:50,50 My:10,10 d:40,40

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Normal Goblin vs House (Expected: Mutually Assured Destruction or House Defense)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.130556, 0.825968) -> Grid(20, 132) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.844397, 0.368346) -> Grid(135, 58) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.494344, 0.658403) -> Grid(79, 105) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.555038, 0.353638) -> Grid(88, 56) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.085327, 0.269777) -> Grid(13, 43) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.987745, 0.060848) -> Grid(158, 9) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Normal Goblin vs House (Expected: Mutually Assured Destruction or House Defense)
Goblin constructor: calling super...
[Entity 2] Calling registerEntity...
[Entity 2] registerEntity returned.
[Entity 2] Calling updatePosition...
[Entity 2] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
Check updateCombatLogic: function
Goblin Raid: House population reduced.Rem: 9 
Goblin Raid: House population reduced.Rem: 8 
Goblin(normal) died.ID:1 
[Goblin vs House]
 Start: Goblin vs House (Pop:10)
End: Goblin Dead=true House Pop=8 Frames=64

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Normal Goblin vs House (Expected: Mutually Assured Destruction or House Defense)
[Game] Dispose called for Game Instance.

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs Normal Goblin (Expected: Knight Stomp)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.641594, 0.525916) -> Grid(102, 84) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.078604, 0.370551) -> Grid(12, 59) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.068608, 0.965922) -> Grid(10, 154) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.189715, 0.765254) -> Grid(30, 122) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.926024, 0.615014) -> Grid(148, 98) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.210486, 0.834853) -> Grid(33, 133) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should NOT drop manual job when switching to Sleep at night
[Game] Dispose called for Game Instance.
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.747703, 0.231325) -> Grid(119, 37) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.334099, 0.312033) -> Grid(53, 49) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.704756, 0.427252) -> Grid(112, 68) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should NOT drop manual job when switching to Sleep at night
[Entity 2] Calling updatePosition...
[Entity 2] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Game] Request Added: raise at (50,50) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 50,50 (H:5). Reachable:true Dist:56.57 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 56.6 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should NOT drop manual job when switching to Sleep at night
[Actor 0] smartMove to 50,50 (H:5). Reachable:true Dist:56.57 Moving:false Path:1
[Actor 0] SmartMove Depth:1 Node:50,50 My:10,10 d:40,40
[Entity 0] startMove -> isMoving:true. Target:50,50 StartTime:0.0000

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs Normal Goblin (Expected: Knight Stomp)
[Entity 3] Calling registerEntity...
[Entity 3] registerEntity returned.
[Entity 3] Calling updatePosition...
[Entity 3] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:1 Role:knight Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:1 Role:knight Pos:10,10
Goblin constructor: calling super...
[Entity 4] Calling registerEntity...
[Entity 4] registerEntity returned.
[Entity 4] Calling updatePosition...
[Entity 4] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
Goblin hit Unit! Dmg: 15 UnitHP: 995 
Goblin hit Unit! Dmg: 15 UnitHP: 980.0336000000011 
Goblin hit Unit! Dmg: 15 UnitHP: 965.0672000000022 
Goblin hit Unit! Dmg: 15 UnitHP: 950.1008000000033 
Goblin hit Unit! Dmg: 15 UnitHP: 935.1344000000045 
Goblin hit Unit! Dmg: 15 UnitHP: 920.1680000000056 
Goblin hit Unit! Dmg: 15 UnitHP: 905.2016000000067 
Goblin hit Unit! Dmg: 15 UnitHP: 890.2352000000078 
Goblin hit Unit! Dmg: 15 UnitHP: 875.2688000000089 
Goblin hit Unit! Dmg: 15 UnitHP: 860.30240000001 
Goblin hit Unit! Dmg: 15 UnitHP: 845.3360000000112 
Goblin hit Unit! Dmg: 15 UnitHP: 830.3696000000123 
Goblin hit Unit! Dmg: 15 UnitHP: 815.4032000000134 
Goblin hit Unit! Dmg: 15 UnitHP: 800.4368000000145 
Goblin hit Unit! Dmg: 15 UnitHP: 785.4704000000156 
Goblin hit Unit! Dmg: 15 UnitHP: 770.5040000000167 
[Knight vs Normal]
 Start: Unit(knight HP:1010/1010 Dmg:300) vs Goblin(normal HP:50/50 Dmg:15)
End: Winner=Draw Frames=1000
Final: Unit HP:770.5 Goblin HP:50.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs Normal Goblin (Expected: Knight Stomp)
[Game] Dispose called for Game Instance.

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should abandon unreachable job (Abandonment Test)
[Game] Dispose called for Game Instance.
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.120600, 0.098579) -> Grid(19, 15) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.976050, 0.144011) -> Grid(156, 23) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.815405, 0.114168) -> Grid(130, 18) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs King Goblin (Expected: Close or King Advantage)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.432931, 0.961831) -> Grid(69, 153) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.748956, 0.332792) -> Grid(119, 53) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.036803, 0.761059) -> Grid(5, 121) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.808029, 0.948738) -> Grid(129, 151) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.707733, 0.655337) -> Grid(113, 104) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.861419, 0.608269) -> Grid(137, 97) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/ComplexAI.test.js > Complex AI Scenarios > should abandon unreachable job (Abandonment Test)
[Entity 3] Calling updatePosition...
[Entity 3] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10 Special:false
[Unit 0] State Change: None -> Wander
[UnitCore.js] Unit Created ID:0 Role:worker Pos:10,10
[Game] Request Added: raise at (90,90) ID:req_0
[Game] No worker in radius 80 for Manual Req req_0. Trying Global Scan...
[Unit 0] State Change: Wander -> Job
[Actor 0] smartMove to 90,90 (H:5). Reachable:true Dist:28.28 Moving:false Path:0
[Actor 0] smartMove: triggers pathfinding. Dist: 28.3 Time:0.0 Last:0.0 Throttle:1.00 Action:Approaching Job
[Game] Request req_0 Deferred (Excluded) for 3s until 3.1
[Unit 0] State Change: Job -> Wander

 × src/tests/ComplexAI.test.js > Complex AI Scenarios > should drop job gracefully if target building is destroyed 33ms
   → expected { id: 'req_0', …(12) } to be null
 ✓ src/tests/ComplexAI.test.js > Complex AI Scenarios > should prioritize manual jobs even when closer auto jobs appear 10ms
 ✓ src/tests/ComplexAI.test.js > Complex AI Scenarios > should NOT drop manual job when switching to Sleep at night 13ms
 ✓ src/tests/ComplexAI.test.js > Complex AI Scenarios > should abandon unreachable job (Abandonment Test) 10ms
stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs King Goblin (Expected: Close or King Advantage)
[Entity 5] Calling registerEntity...
[Entity 5] registerEntity returned.
[Entity 5] Calling updatePosition...
[Entity 5] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:2 Role:knight Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:2 Role:knight Pos:10,10
Goblin constructor: calling super...
[Entity 6] Calling registerEntity...
[Entity 6] registerEntity returned.
[Entity 6] Calling updatePosition...
[Entity 6] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
Goblin hit Unit! Dmg: 80 UnitHP: 926 
Goblin hit Unit! Dmg: 80 UnitHP: 846.0400000000013 
Goblin hit Unit! Dmg: 80 UnitHP: 766.0800000000027 
Goblin hit Unit! Dmg: 80 UnitHP: 686.120000000004 
Goblin hit Unit! Dmg: 80 UnitHP: 606.1600000000053 
Goblin hit Unit! Dmg: 80 UnitHP: 526.2000000000066 
Goblin hit Unit! Dmg: 80 UnitHP: 446.24000000000797 
Goblin hit Unit! Dmg: 80 UnitHP: 366.2800000000093 
Goblin hit Unit! Dmg: 80 UnitHP: 286.3200000000106 
Goblin hit Unit! Dmg: 80 UnitHP: 206.36000000001195 
Goblin hit Unit! Dmg: 80 UnitHP: 126.40000000001328 
Goblin hit Unit! Dmg: 80 UnitHP: 46.440000000012475 
[Unit 2] Death Counter! Hitting 3
Unit 2 (knight) DIED. R.I.P.
Goblin hit Unit! Dmg: 80 UnitHP: 0 
[Knight vs King]
 Start: Unit(knight HP:1006/1006 Dmg:300) vs Goblin(king HP:1552/1552 Dmg:80)
End: Winner=Goblin Frames=933
Final: Unit HP:0.0 Goblin HP:1402.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs King Goblin (Expected: Close or King Advantage)
[Game] Dispose called for Game Instance.

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Wizard vs Hobgoblin (Expected: Wizard High DPS but Fragile)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.179147, 0.944349) -> Grid(28, 151) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.121415, 0.486637) -> Grid(19, 77) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.069774, 0.744175) -> Grid(11, 119) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.901047, 0.541006) -> Grid(144, 86) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.008631, 0.389319) -> Grid(1, 62) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.666036, 0.431560) -> Grid(106, 69) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Wizard vs Hobgoblin (Expected: Wizard High DPS but Fragile)
[Entity 7] Calling registerEntity...
[Entity 7] registerEntity returned.
[Entity 7] Calling updatePosition...
[Entity 7] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:3 Role:wizard Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:3 Role:wizard Pos:10,10
Goblin constructor: calling super...
[Entity 8] Calling registerEntity...
[Entity 8] registerEntity returned.
[Entity 8] Calling updatePosition...
[Entity 8] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
Goblin hit Unit! Dmg: 30 UnitHP: 122 
Goblin hit Unit! Dmg: 30 UnitHP: 92.05013333333233 
Goblin hit Unit! Dmg: 30 UnitHP: 62.10026666666465 
Goblin hit Unit! Dmg: 30 UnitHP: 32.150399999998314 
Goblin hit Unit! Dmg: 30 UnitHP: 2.2005333333319754 
[Unit 3] Death Counter! Hitting 4
Unit 3 (wizard) DIED. R.I.P.
Goblin hit Unit! Dmg: 30 UnitHP: 0 
[Wizard vs Hobgoblin]
 Start: Unit(wizard HP:152/152 Dmg:240) vs Goblin(hobgoblin HP:150/150 Dmg:30)
End: Winner=Goblin Frames=503
Final: Unit HP:0.0 Goblin HP:30.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Wizard vs Hobgoblin (Expected: Wizard High DPS but Fragile)
[Game] Dispose called for Game Instance.

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Goblin King should crush Worker
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.457204, 0.782480) -> Grid(73, 125) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.219991, 0.947770) -> Grid(35, 151) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.884093, 0.856642) -> Grid(141, 137) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)
[GoblinManager] 5個の洞窟を生成中...
[GoblinManager] DETERMINISM: generateCaves start. rngState=undefined
[GoblinManager] DETERMINISM: Attempt 1: Rnd(0.989143, 0.346078) -> Grid(158, 55) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 2: Rnd(0.373238, 0.675098) -> Grid(59, 108) rngState=undefined
[GoblinManager] DETERMINISM: Attempt 3: Rnd(0.653282, 0.863909) -> Grid(104, 138) rngState=undefined
[GoblinManager] 洞窟生成完了: 0/5 (試行回数: 5000)

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Goblin King should crush Worker
[Entity 9] Calling registerEntity...
[Entity 9] registerEntity returned.
[Entity 9] Calling updatePosition...
[Entity 9] updatePosition returned.
[ActorCore] Actor Created. Type: unit Pos: 10,10
[UnitCore.js] Unit Created ID:4 Role:worker Pos:10,10 Special:false
[UnitCore.js] Unit Created ID:4 Role:worker Pos:10,10
Goblin constructor: calling super...
[Entity 10] Calling registerEntity...
[Entity 10] registerEntity returned.
[Entity 10] Calling updatePosition...
[Entity 10] updatePosition returned.
[ActorCore] Actor Created. Type: goblin Pos: 10,10
Goblin constructor: super returned.
Goblin constructor: checking scene...
Goblin constructor: setting ID...
Worker HP: 64, Dmg: 12
King HP: 1541, Dmg: 80
[Unit 4] Death Counter! Hitting 5
Unit 4 (worker) DIED. R.I.P.
Goblin hit Unit! Dmg: 80 UnitHP: 0 
[Worker vs King]
 Start: Unit(worker HP:64/64 Dmg:12) vs Goblin(king HP:1541/1541 Dmg:80)
End: Winner=Goblin Frames=33
Final: Unit HP:0.0 Goblin HP:1535.0

stdout | src/tests/CombatBalance.test.js > Combat Balance Verification > Goblin King should crush Worker
[Game] Dispose called for Game Instance.

 × src/tests/CombatBalance.test.js > Combat Balance Verification > Worker vs Normal Goblin (Expected: Goblin Win due to stats buff) 38ms
   → Cannot read properties of undefined (reading 'dispose')
 × src/tests/CombatBalance.test.js > Combat Balance Verification > Normal Goblin vs House (Expected: Mutually Assured Destruction or House Defense) 9ms
   → Cannot read properties of undefined (reading 'dispose')
 × src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs Normal Goblin (Expected: Knight Stomp) 16ms
   → expected 'Draw' to be 'Unit' // Object.is equality
   → Cannot read properties of undefined (reading 'dispose')
 × src/tests/CombatBalance.test.js > Combat Balance Verification > Knight vs King Goblin (Expected: Close or King Advantage) 10ms
   → Cannot read properties of undefined (reading 'dispose')
 × src/tests/CombatBalance.test.js > Combat Balance Verification > Wizard vs Hobgoblin (Expected: Wizard High DPS but Fragile) 5ms
   → Cannot read properties of undefined (reading 'dispose')
 × src/tests/CombatBalance.test.js > Combat Balance Verification > Goblin King should crush Worker 6ms
   → Cannot read properties of undefined (reading 'dispose')

 Test Files  2 failed (2)
      Tests  7 failed | 3 passed (10)
   Start at  20:53:16
   Duration  1.42s (transform 894ms, setup 135ms, import 986ms, tests 155ms, environment 1.00s)

